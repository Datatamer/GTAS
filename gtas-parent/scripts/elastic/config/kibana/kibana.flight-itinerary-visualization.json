{"id":"29ac1380-66a9-11e9-9ffd-9d63a89be4bb","type":"visualization","updated_at":"2019-06-18T19:03:49.268Z","version":41,"attributes":{"title":"Flight Itinerary Work In Progress","visState":"{\"title\":\"Flight Itinerary Work In Progress\",\"type\":\"vega\",\"params\":{\"spec\":\"{\\n  $schema: https://vega.github.io/schema/vega/v3.0.json\\n  config: {\\n    kibana: {type: \\\"map\\\", latitude: 0, longitude: 20, zoom: 1}\\n  }\\n  data: [\\n    {\\n      name: flight_nodes\\n      url: {\\n        index: flightpax\\n        %context%: true\\n        body: {\\n          aggs: {\\n            flight_legs_lines: {\\n              terms: {field: \\\"flightId\\\", size: 100}\\n              aggs: {\\n                lines: {\\n                  top_hits: {\\n                    size: 1\\n                    _source: {\\n                      includes: [\\n                        flight_legs.leg_number\\n                        flight_legs.origin_coordination\\n                        flight_legs.destination_coordination\\n                        flight_legs.destination\\n                        flight_legs.origin\\n                        flight_nodes.id\\n                        flight_nodes.lat\\n                        flight_nodes.lon\\n                        flight_edges.from\\n                        flight_edges.to\\n                        flight_edges.leg_number\\n                      ]\\n                    }\\n                  }\\n                }\\n              }\\n            }\\n          }\\n          size: 0\\n        }\\n      }\\n      format: {\\n        property: aggregations.flight_legs_lines.buckets[0].lines.hits.hits[0]._source.flight_nodes\\n      }\\n    }\\n    {\\n      name: flight_edges\\n      url: {\\n        index: flightpax\\n        %context%: true\\n        body: {\\n              \\n          aggs: {\\n            flight_legs_lines: {\\n              terms: {field: \\\"flightId\\\", size: 100}\\n              aggs: {\\n                lines: {\\n                  top_hits: {\\n                    size: 1\\n                    _source: {\\n                      includes: [\\n                        flight_legs.leg_number\\n                        flight_legs.origin_coordination\\n                        flight_legs.destination_coordination\\n                        flight_legs.destination\\n                        flight_legs.origin\\n                        flight_nodes.id\\n                        flight_nodes.lat\\n                        flight_nodes.lon\\n                        flight_edges.from\\n                        flight_edges.to\\n                        flight_edges.leg_number\\n                      ]\\n                    }\\n                  }\\n                }\\n              }\\n            }\\n          }\\n          size: 0\\n        }\\n      }\\n      format: {\\n        property: aggregations.flight_legs_lines.buckets[0].lines.hits.hits[0]._source.flight_edges\\n      }\\n    }\\n    {\\n      name: nodes\\n      source: flight_nodes\\n      transform: [\\n        {\\n          type: geopoint\\n          projection: projection\\n          fields: [\\\"lon\\\", \\\"lat\\\"]\\n        }\\n      ]\\n    }\\n    {\\n      name: edges\\n      source: flight_edges\\n      transform: [\\n        {\\n          type: lookup\\n          from: nodes\\n          key: id\\n          fields: [\\\"from\\\", \\\"to\\\"]\\n          as: [\\\"source\\\", \\\"target\\\"]\\n        }\\n        {\\n          type: linkpath\\n          sourceX: source.x\\n          sourceY: source.y\\n          targetX: target.x\\n          targetY: target.y\\n          orient: {signal: \\\"orient\\\"}\\n          shape: {signal: \\\"shape\\\"}\\n        }\\n      ]\\n    }\\n  ]\\n  marks: [\\n    {\\n      type: path\\n      from: {data: \\\"edges\\\"}\\n      encode: {\\n        update: {\\n          stroke: {value: \\\"brown\\\"}\\n          strokeWidth: {value: 3}\\n          path: {field: \\\"path\\\"}\\n          tooltip: {\\n            signal: \\\"{title: 'Flight from ' + datum.from + ' to ' + datum.to, Flight:datum.from + ' to ' + datum.to, Leg_number: datum.leg_number}\\\"\\n          }\\n        }\\n      }\\n    }\\n    {\\n      name: node\\n      type: symbol\\n      from: {data: \\\"nodes\\\"}\\n      encode: {\\n        update: {\\n          stroke: {value: \\\"brown\\\"}\\n          fill: {value: \\\"brown\\\"}\\n          strokeWidth: {value: 16}\\n          shape: {value: \\\"circle\\\"}\\n          xc: {signal: \\\"datum.x\\\"}\\n          yc: {signal: \\\"datum.y\\\"}\\n          tooltip: {signal: \\\"{title: datum.id }\\\"}\\n        }\\n      }\\n    }\\n    {\\n      type: text\\n      from: {data: \\\"nodes\\\"}\\n      encode: {\\n        update: {\\n          text: {field: \\\"id\\\"}\\n          align: {value: \\\"center\\\"}\\n          fontSize: {value: \\\"10\\\"}\\n          fontWieght: {value: \\\"bold\\\"}\\n          fill: {value: \\\"white\\\"}\\n          stroke: {value: \\\"white\\\"}\\n          xc: {signal: \\\"datum.x\\\"}\\n          yc: {signal: \\\"datum.y\\\"}\\n          zindex: {value: 1}\\n        }\\n      }\\n    }\\n  ]\\n  signals: [\\n    {\\n      name: orient\\n      value: \\\"vertical\\\" // bind: {      //   input: select      //   options: [\\\"vertical\\\", \\\"horizontal\\\", \\\"radial\\\"]      // }\\n    }\\n    {\\n      name: shape\\n      value: \\\"diagonal\\\" // bind: {      //   input: select      //   options: [\\\"line\\\", \\\"arc\\\", \\\"curve\\\", \\\"diagonal\\\", \\\"orthogonal\\\"]      // }\\n    }\\n  ]\\n}\"},\"aggs\":[]}","uiStateJSON":"{}","description":"","version":1,"kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"language\":\"kuery\",\"query\":\"\"},\"filter\":[]}"}}}